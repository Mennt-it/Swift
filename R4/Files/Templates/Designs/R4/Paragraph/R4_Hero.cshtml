@inherits Dynamicweb.Rendering.ViewModelTemplate<Dynamicweb.Frontend.ParagraphViewModel>
@using Dynamicweb.Frontend

@{ 
	string layoutSetting = !string.IsNullOrEmpty(Model.Item.GetString("Layout")) ? Model.Item.GetList("Layout").SelectedValue : "center-middle";
	string horizontalAlign = "justify-content-center";
	string verticalAlign = "";

	if (layoutSetting.Contains("center")) {
		horizontalAlign = "justify-content-center";
	}
	if (layoutSetting.Contains("left")) {
		horizontalAlign = "justify-content-left";
	}
	if (layoutSetting.Contains("middle")) {
		verticalAlign = "align-items-center";
	}
	if (layoutSetting.Contains("bottom")) {
		verticalAlign = "align-items-end";
	}

    string imageAspectRatio = Model.Item?.GetList("ImageAspectRatio").SelectedValue ?? "0";
	string imageContainerClasses = "position-absolute h-100 w-100 top-0";
	string contentContainerClasses = "position-relative h-100 w-100 p-3";

	if (imageAspectRatio != "0") {
        imageContainerClasses = "position-relative ratio ratio-" + imageAspectRatio;
	    contentContainerClasses = "position-absolute h-100 w-100 top-0 p-3";
	}
}

<div class="item py-3">   
    <div class="position-relative d-flex top-0 h-100 w-100 @verticalAlign">
        @if (!string.IsNullOrEmpty(Model.Item.GetString("Image")))
        {
            string imagePath = Model.Item?.GetFile("Image")?.Path ?? "";
            imagePath = "/Admin/Public/GetImage.ashx?width=" + 1920 + "&height=" + 845 + "&image=" + imagePath + "&Format=WebP&Quality=100";

            int xPos = Model.Item?.GetFile("Image")?.FocalPositionFromLeft ?? 50;
            int yPos = Model.Item?.GetFile("Image")?.FocalPositionFromTop ?? 50;

            <div class="@imageContainerClasses">
                <img loading="lazy" src="@imagePath" style="object-fit: cover; object-position: @(xPos)% @(yPos)%" class="w-100 h-100" title="@Model.Item.GetString("Title")" alt="@Model.Item.GetString("Title")" />
            </div>
        }
        <div class="@contentContainerClasses">
            <div class="d-flex @horizontalAlign @verticalAlign h-100 text-white">
                <div style="max-width:700px;">
                    @if (!string.IsNullOrEmpty(Model.Item.GetString("Title")) && !Model.Item.GetBoolean("HideTitle"))
                    {
                        <h2 class="h2">@Model.Item.GetString("Title")</h2>
                    }
                    @if (!string.IsNullOrEmpty(Model.Item.GetString("Text")))
                    {
                        <p>@Model.Item.GetString("Text")</p>
                    }
                    @if (!string.IsNullOrEmpty(Model.Item.GetString("ButtonLink")) && !string.IsNullOrEmpty(Model.Item.GetString("ButtonLabel")))
                    {
                        <div>
                            <a href="@Model.Item.GetString("ButtonLink")" class="btn btn-primary btn-giant">@Model.Item.GetString("ButtonLabel")</a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
