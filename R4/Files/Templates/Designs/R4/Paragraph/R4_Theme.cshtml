@inherits Dynamicweb.Rendering.ViewModelTemplate<Dynamicweb.Frontend.ParagraphViewModel>

@{
	string themeClassName = !string.IsNullOrWhiteSpace(Model.Item.GetString("CSSClassName")) ? Model.Item.GetString("CSSClassName").Replace(" ", "").Trim().ToLower() : "";
	string foregroundColor = Model.Item.GetString("ForegroundColor") != null ? Model.Item.GetString("ForegroundColor") : "";
	foregroundColor = foregroundColor == "" ? "transparent" : foregroundColor;
	string backgroundColor = Model.Item.GetString("BackgroundColor") != null ? Model.Item.GetString("BackgroundColor") : "";
	backgroundColor = backgroundColor == "" ? "transparent" : backgroundColor;
	string borderColor = Model.Item.GetString("BorderColor") != null ? Model.Item.GetString("BorderColor") : "";
	borderColor = borderColor == "" ? "transparent" : borderColor;
	string buttonPrimaryBackgroundColor = Model.Item.GetString("ButtonPrimaryBackgroundColor") != null ? Model.Item.GetString("ButtonPrimaryBackgroundColor") : "";
	buttonPrimaryBackgroundColor = buttonPrimaryBackgroundColor == "" ? "transparent" : buttonPrimaryBackgroundColor;
	string buttonPrimaryForegroundColor = Model.Item.GetString("ButtonPrimaryForegroundColor") != null ? Model.Item.GetString("ButtonPrimaryForegroundColor") : "";
	buttonPrimaryForegroundColor = buttonPrimaryForegroundColor == "" ? "transparent" : buttonPrimaryForegroundColor;
	string buttonSecondaryBackgroundColor = Model.Item.GetString("ButtonSecondaryBackgroundColor") != null ? Model.Item.GetString("ButtonSecondaryBackgroundColor") : "";
	buttonSecondaryBackgroundColor = buttonSecondaryBackgroundColor == "" ? "transparent" : buttonSecondaryBackgroundColor;
	string buttonSecondaryForegroundColor = Model.Item.GetString("ButtonSecondaryForegroundColor") != null ? Model.Item.GetString("ButtonSecondaryForegroundColor") : "";
	buttonSecondaryForegroundColor = buttonSecondaryForegroundColor == "" ? "transparent" : buttonSecondaryForegroundColor;

	var sb = new System.Text.StringBuilder();

	sb.AppendLine("." + themeClassName + "{");
	if (!string.IsNullOrEmpty(foregroundColor))
	{
		sb.AppendLine($"--r4-foreground-color: {foregroundColor};");
	}
	if (!string.IsNullOrEmpty(backgroundColor))
	{
		sb.AppendLine($"--r4-background-color: {backgroundColor};");
	}
	if (!string.IsNullOrEmpty(borderColor))
	{
		sb.AppendLine($"--r4-border-color: {borderColor};");
	}
	if (!string.IsNullOrEmpty(buttonPrimaryBackgroundColor))
	{
		sb.AppendLine($"--r4-button-primary-background-color: {buttonPrimaryBackgroundColor};");
	}
	if (!string.IsNullOrEmpty(buttonPrimaryForegroundColor))
	{
		sb.AppendLine($"--r4-button-primary-foreground-color: {buttonPrimaryForegroundColor};");
	}
	if (!string.IsNullOrEmpty(buttonSecondaryBackgroundColor))
	{
		sb.AppendLine($"--r4-button-secondary-background-color: {buttonSecondaryBackgroundColor};");
	}
	if (!string.IsNullOrEmpty(buttonSecondaryForegroundColor))
	{
		sb.AppendLine($"--r4-button-secondary-foreground-color: {buttonSecondaryForegroundColor};");
	}
	sb.AppendLine("}"); 

	Dynamicweb.Core.Helpers.TextFileHelper.WriteTextFile(sb.ToString() + Environment.NewLine, Dynamicweb.Context.Current.Server.MapPath($"/Files/Templates/Designs/R4/_parsed/R4_css/R4_theme_styles_{Dynamicweb.Services.Pages.GetPage(Model.PageID).AreaId}.tmp"), true);
}

@if (themeClassName != "") { 
	<text>
	.@themeClassName {
		@if (!string.IsNullOrEmpty(foregroundColor))
		{<text>--r4-foreground-color: @foregroundColor;</text>}
		@if (!string.IsNullOrEmpty(backgroundColor))
		{<text>--r4-background-color: @backgroundColor;</text>}
		@if (!string.IsNullOrEmpty(borderColor))
		{<text>--r4-border-color: @borderColor;</text>}
		@if (!string.IsNullOrEmpty(buttonPrimaryBackgroundColor))
		{<text>--r4-button-primary-background-color: @buttonPrimaryBackgroundColor;</text>}
		@if (!string.IsNullOrEmpty(buttonPrimaryForegroundColor))
		{<text>--r4-button-primary-foreground-color: @buttonPrimaryForegroundColor;</text>}
		@if (!string.IsNullOrEmpty(buttonSecondaryBackgroundColor))
		{<text>--r4-button-secondary-background-color: @buttonSecondaryBackgroundColor;</text>}
		@if (!string.IsNullOrEmpty(buttonSecondaryForegroundColor))
		{<text>--r4-button-secondary-foreground-color: @buttonSecondaryForegroundColor;</text>}
	}	
	</text>
}


