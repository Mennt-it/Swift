@inherits Dynamicweb.Rendering.RazorTemplateBase<Dynamicweb.Rendering.RazorTemplateModel<Dynamicweb.Rendering.Template>>
@helper RenderStepSummaryDeliveryMethod()
{
	string shippingMethod = GetString("Ecom:Order.ShippingMethod"),
	editStep = "CartV2.GotoStep1";

	if (!string.IsNullOrEmpty(shippingMethod))
	{

		List<string> shippingDetails = new List<string>();

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Company")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.Company"));
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Name")))
		{
			if (GetString("Ecom:Order.Delivery.Company") != GetString("Ecom:Order.Delivery.Name"))
			{
				shippingDetails.Add(GetString("Ecom:Order.Delivery.Name"));
			}
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.Address"));
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address2")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.Address2"));
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Zip")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.Zip"));
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.City")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.City"));
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Region")))
		{
			string regionName = GetString("Ecom:Order.Delivery.Region");
			foreach (LoopItem region in GetLoop("DeliveryRegions"))
			{
				if (region.GetString("Ecom:DeliveryRegion.IsDeliveryRegion") == "true")
				{
					regionName = region.GetString("Ecom:DeliveryRegion.Name");
				}
			}
			shippingDetails.Add(regionName);
		}

		if (!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Country")))
		{
			shippingDetails.Add(GetString("Ecom:Order.Delivery.Country"));
		}

		string shippingDetailsString = (string.Join(", ", shippingDetails.Select(x => x).ToArray()));

		<div class="list-group-item py-2 fs-7" style="background-color: rgba(var(--swift-foreground-color-rgb), 0.05)" id="DeliveryGroup">
			<dl class="grid gap-1 gap-sm-3 mb-0">
				<dt class="g-col-8 g-col-sm-4 fw-normal">@Translate("Delivery")</dt>
				<dd class="d-flex flex-column g-col-12 g-col-sm-7 order-2 order-sm-1 mb-0">
					<span>@shippingMethod</span>
					@if (!string.IsNullOrEmpty(shippingDetailsString))
					{
						<span class="opacity-75 fs-8">
							@shippingDetailsString
						</span>
					}
				</dd>
				<dd class="g-col-4 g-col-sm-1 order-1 order-sm-2 mb-0 text-end">
					<button class="btn btn-small btn-link fs-8 p-0" type="submit" name="@editStep" id="EditDeliveryButton">
						<span class="text-uppercase">@Translate("Edit")</span>
					</button>
				</dd>
			</dl>
		</div>
	}
}
