@inherits Dynamicweb.Rendering.RazorTemplateBase<Dynamicweb.Rendering.RazorTemplateModel<Dynamicweb.Rendering.Template>>

@{
	bool isPaymentStep = GetLoop("StepButtons").Count == 0;
	int currentStep = !isPaymentStep ? 1 : 4;
	int currentUserId = Dynamicweb.Core.Converter.ToInt32(GetGlobalValue("Global:Extranet.UserID"));

	foreach (LoopItem step in GetLoop("StepButtons"))
	{
		if (step.GetBoolean("Step.Current"))
		{
			currentStep = step.GetInteger("Step.Number");
		}
	}
}

@if (!string.IsNullOrEmpty(GetString("UserManagement:User.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingMethodID")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.PaymentMethodID")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Name")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Company")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Address2")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Zip")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.City")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Email")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Delivery.Phone")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Name")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Company")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Address")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Address2")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Zip")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.City")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Email")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.Customer.Phone")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingMethod")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.ShippingDate")) ||
	!string.IsNullOrEmpty(GetString("Ecom:Order.PaymentMethod")))
{
	@* User *@
	if (currentUserId != 0)
	{
		<div class="list-group mb-5">
			@Include("StepSummaryOrderCustomer.cshtml")
			@Include("StepSummaryUser.cshtml")

			@if (currentStep != 1)
			{
				@:@Include("StepSummaryOrderDelivery.cshtml")
				@:@Include("StepSummaryDeliveryMethod.cshtml")
				@:@Include("StepSummaryDeliveryDate.cshtml")
			}
		</div>
	}

	@* Anonymous *@
	else
	{
		if (currentStep != 1)
		{
			<div class="list-group">
				@Include("StepSummaryOrderCustomer.cshtml")
				@Include("StepSummaryOrderDelivery.cshtml")

				@if (currentStep > 2)
				{
					@:@Include("StepSummaryDeliveryMethod.cshtml")
					@:@Include("StepSummaryDeliveryDate.cshtml")
				}
				@if (currentStep > 3)
				{
					@:@Include("StepSummaryPaymentMethod.cshtml")
					@:@Include("StepSummaryOrderReference.cshtml")
				}
			</div>
		}
	}
}







