@inherits Dynamicweb.Rendering.ViewModelTemplate<Dynamicweb.Frontend.FileViewModel>

@if (!string.IsNullOrEmpty(Model.Path))
{
	string imagePath = Model?.Path ?? "";
	imagePath = Dynamicweb.Context.Current.Server.UrlEncode(imagePath);
	int imageColumnCount = GetViewParameterInt32("columns");

	int xPos = Model?.FocalPositionFromLeft ?? 50;
	int yPos = Model?.FocalPositionFromTop ?? 50;
	string cssPosition = $"{xPos}% {yPos}%";

	var imageWidth = 640;

	if (imageColumnCount == 2)
	{
		imageWidth = imageWidth / 2;
	}
	else if (imageColumnCount == 3)
	{
		imageWidth = imageWidth / 3;
	}

	@* Image sizes + a fallback image *@
	string image = $"/Admin/Public/GetImage.ashx?image={imagePath}&width={imageWidth}&format=webp";

	@* attributes to send to the image tag *@
	var cssClass = GetViewParameter("cssClass");
	var style = GetViewParameter("style");
	string alt = GetViewParameterString("alt");
    

	<img src="@image" class="@cssClass" style="@(style); border:0;display:block;height:auto;max-width:100%;" alt="@alt"/>
}
