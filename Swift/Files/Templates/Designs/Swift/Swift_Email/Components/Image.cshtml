@inherits Dynamicweb.Rendering.ViewModelTemplate<Dynamicweb.Frontend.FileViewModel>

@if (!string.IsNullOrEmpty(Model.Path))
{
	string imagePath = Model?.Path ?? "";
	imagePath = Dynamicweb.Context.Current.Server.UrlEncode(imagePath);
	int columnCount = GetViewParameterInt32("columns");
	int padding = GetViewParameterInt32("padding");

	var imageWidth = 640 - (padding * 2);

	if (columnCount == 2)
	{
		imageWidth = (imageWidth - (padding * 2)) / 2;
	}
	else if (columnCount == 3)
	{
		imageWidth = (imageWidth - (padding * 2)) / 3;
	}

	string image = $"/Admin/Public/GetImage.ashx?image={imagePath}&width={imageWidth}&format=webp";
	var cssClass = GetViewParameter("cssClass");
	string alt = GetViewParameterString("alt");

	<img src="@image" class="@cssClass" style="border:0;display:block;height:auto;max-width:100%;" border="0" alt="@alt"/>
}
